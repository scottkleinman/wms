{% extends "base.html" %}
{% block main %}
<!-- Section -->
<a name="features"></a>
<section>
    <div class="container">
        <div class="jumbotron">
          <h1>PySiQ server example</h1>
          <p>A Python Simple Queue system for your apps.</p>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">Add a new task</div>
          <div class="panel-body">
            <div>
              <div class="form-group">
                <label for="task_name">Task name:</label>
                <input type="text" class="form-control" id="task_name" name="task_name">
              </div>
              <div class="form-group">
                <label for="n_seconds">Duration (seconds):</label>
                <input type="number" class="form-control" id="n_seconds" name="n_seconds">
              </div>
              <div class="form-group">
                <label for="task_name">A message to show when task ends:</label>
                <input type="text" class="form-control" id="task_result" name="task_result">
              </div>
              <button class="btn btn-default" ng-click="addNewTask(task_name, n_seconds, task_result, [], [])">Run it!</button>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">Queue content <a style="margin-top:-5px;"class="btn btn-danger btn-sm pull-right" ng-click="clearTasks()"><span class="glyphicon glyphicon-trash"></span> Clear tasks</a></div>
          <div class="panel-body">
            <table class="table">
              <thead>
                <tr>
                  <th>Task name</th>
                  <th>Task ID</th>
                  <th>Status</th>
                  <th>Result</th>
                </tr>
              </thead>
              <tbody>
                {% for task in tasks|sort(reverse=True) %}
                <tr>
                  <td>{{task.task_name|safe}}</td>
                  <td>{{task.task_id|safe}}</td>
                  <td>
                    {% if task.status == 3 %}
                    <span class="label label-primary">{{task.status|safe}}</span>
                    {% elif task.status == 2 %}
                    <span class="label label-info">{{task.status|safe}}</span>
                    {% elif task.status == 1 %}
                    <span class="label label-success">{{task.status|safe}}</span>
                    {% elif task.status == 0 %}
                    <span class="label label-danger">{{task.status|safe}}</span>
                    {% else %}
                    <span class="label label-default">{{task.status|safe}}</span>
                    {% endif %}
                    <!-- I'm not sure I've converted from Angular correctly. Here is the original: -->
                    <!-- <span ng-if="['QUEUED'].indexOf(task.status) > -1" class="label label-primary">{{task.status|safe}}</span>
                    <span ng-if="['STARTED'].indexOf(task.status) > -1" class="label label-info">{{task.status|safe}}</span>
                    <span ng-if="['FINISHED'].indexOf(task.status) > -1" class="label label-success">{{task.status|safe}}</span>
                    <span ng-if="['FAILED'].indexOf(task.status) > -1" class="label label-danger">{{task.status|safe}}</span>
                    <span ng-if="['QUEUED', 'STARTED', 'FINISHED', 'FAILED'].indexOf(task.status) === -1" class="label label-default">{{task.status|safe}}</span> -->
                  </td>
                  <td>{{task.result|safe}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
    </div>
</section>
{% endblock main %}
